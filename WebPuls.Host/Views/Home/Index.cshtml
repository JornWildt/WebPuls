@{
    ViewBag.Title = "Web Puls";
}

<div id="paper1"></div>

@section scripts {
  <!--Script references. -->
  <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
  <!--Reference the SignalR library. -->
  <script type="text/javascript" src="~/Scripts/jquery.signalR-2.0.3.js"></script>
  <!--Reference the autogenerated SignalR hub script. -->
  <script src="~/signalr/hubs"></script>
  <!-- Reference Raphael graphics library -->
  <script type="text/javascript" src="~/Scripts/raphael-min.js"></script>

  <script>
    $(function () {
      var w = $(window).width();
      var h = $(window).height();

      // Create graphics paper for Raphael and paint background
      var paper = Raphael("paper1", w, h);

      var rect = paper.rect(0, 0, w, h);
      rect.attr("fill", "#000");
      rect.attr("stroke", "#000");

      // Reference the auto-generated proxy for the hub.  
      var puls = $.connection.pulsHub;
      $.connection.hub.start();

      puls.client.addBlimp = function (x, y, color, size, lifetime) {
        x = x * w / 100;
        y = y * h / 100;
        var circle = paper.circle(x, y, size).attr({ fill: color, stroke: color });
        circle.animate({ opacity: 0.5, transform: "s3" }, 800, "linear", function () { this.remove(); });

        circle = paper.circle(x, y, size).attr({ fill: color, stroke: color });
        circle.animate({ opacity: 0.8 }, lifetime, "linear", function () { this.remove(); });
      };
    });
  </script>
}